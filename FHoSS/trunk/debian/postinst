#!/bin/sh
# postinst script for fhoss
#
# see: dh_installdeb(1)

# set -e

. /usr/share/debconf/confmodule

# summary of how this script can be called:
#        * <postinst> `configure' <most-recently-configured-version>
#        * <old-postinst> `abort-upgrade' <new version>
#        * <conflictor's-postinst> `abort-remove' `in-favour' <package>
#          <new-version>
#        * <postinst> `abort-remove'
#        * <deconfigured's-postinst> `abort-deconfigure' `in-favour'
#          <failed-install-package> <version> `removing'
#          <conflicting-package> <version>
# for details, see http://www.debian.org/doc/debian-policy/ or
# the debian-policy package


case "$1" in
    configure)
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

if [ "$1" = "configure" ]; then
	CONF_DIR="/etc/fhoss"
	FHOSS_DIR="/usr/share/java/fhoss-0.2"

	for CONF in c3p0.properties DiameterPeerHSS.xml hibernate.properties hss.properties log4j.properties; do
		if [ -d "$FHOSS_DIR" -a ! -e "$FHOSS_DIR/$CONF" -a -e "$CONF_DIR/$CONF" ]; then
			ln -s "$CONF_DIR/$CONF" "$FHOSS_DIR/$CONF"
		fi
	done

	LOG4J=$CONF_DIR/log4j.properties
	if [ -e $LOG4J ]; then
		sed -e 's/WARN, MYCONSOLE, LOGFILE, LOGFILE2/WARN, LOGFILE, LOGFILE2/' \
		    -e 's/=logs/=\/var\/log/' $LOG4J > $LOG4J.tmp
		mv $LOG4J.tmp $LOG4J
	fi
fi

exit 0
